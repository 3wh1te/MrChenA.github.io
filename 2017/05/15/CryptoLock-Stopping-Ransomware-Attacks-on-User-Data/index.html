<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="目录 介绍和相关工作 标识 实现 实验评估  PS：平时多备份，灾时少流泪！">
<meta property="og:type" content="article">
<meta property="og:title" content="CryptoLock Stopping Ransomware Attacks on User Data">
<meta property="og:url" content="http://yoursite.com/2017/05/15/CryptoLock-Stopping-Ransomware-Attacks-on-User-Data/index.html">
<meta property="og:site_name" content="Mr.Chen --勿忘初衷">
<meta property="og:description" content="目录 介绍和相关工作 标识 实现 实验评估  PS：平时多备份，灾时少流泪！">
<meta property="og:updated_time" content="2017-05-31T09:11:27.989Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CryptoLock Stopping Ransomware Attacks on User Data">
<meta name="twitter:description" content="目录 介绍和相关工作 标识 实现 实验评估  PS：平时多备份，灾时少流泪！">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/05/15/CryptoLock-Stopping-Ransomware-Attacks-on-User-Data/"/>





  <title>CryptoLock Stopping Ransomware Attacks on User Data | Mr.Chen --勿忘初衷</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Mr.Chen --勿忘初衷</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">勿忘初衷</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/15/CryptoLock-Stopping-Ransomware-Attacks-on-User-Data/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Chen">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.Chen --勿忘初衷">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">CryptoLock Stopping Ransomware Attacks on User Data</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-15T12:17:25+08:00">
                2017-05-15
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/15/CryptoLock-Stopping-Ransomware-Attacks-on-User-Data/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/05/15/CryptoLock-Stopping-Ransomware-Attacks-on-User-Data/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/05/15/CryptoLock-Stopping-Ransomware-Attacks-on-User-Data/" class="leancloud_visitors" data-flag-title="CryptoLock Stopping Ransomware Attacks on User Data">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a><strong>目录</strong></h2><ul>
<li><strong>介绍和相关工作</strong></li>
<li><strong>标识</strong></li>
<li><strong>实现</strong></li>
<li><strong>实验评估</strong></li>
</ul>
<h1 id="PS：平时多备份，灾时少流泪！"><a href="#PS：平时多备份，灾时少流泪！" class="headerlink" title="PS：平时多备份，灾时少流泪！"></a>PS：平时多备份，灾时少流泪！</h1><a id="more"></a>
<h1 id="一、介绍和相关工作"><a href="#一、介绍和相关工作" class="headerlink" title="一、介绍和相关工作"></a>一、介绍和相关工作</h1><h2 id="1、现状"><a href="#1、现状" class="headerlink" title="1、现状"></a>1、现状</h2><ul>
<li>加密的数据是可恢复的（和破坏性的恶意软件不同）</li>
<li>通过比特币进行匿名支付</li>
<li>存在了将近十年</li>
<li>每年几百万美元的损失^[37]</li>
<li>法律机构收到侵害，损失重要文件（只能选择支付）^[4][18]</li>
</ul>
<h2 id="2、难点"><a href="#2、难点" class="headerlink" title="2、难点"></a>2、难点</h2><ul>
<li>这种恶意软件容易上手</li>
<li>通过行为难以区分是否为恶意软件</li>
<li>主要面向小白用户（从不会数据备份）</li>
</ul>
<h2 id="3、论文所做工作"><a href="#3、论文所做工作" class="headerlink" title="3、论文所做工作"></a>3、论文所做工作</h2><ul>
<li><p><strong>Develp an early-warning system</strong>：第一个检测用户数据变化的检测系统，目的不是一个文件都不损失，而是损失一部分来发现恶意行为，终止行为。基于Windows平台。</p>
</li>
<li><p><strong>Indentify three primary indicators</strong>：找到三个主要行为标识来标识这种恶意行为</p>
</li>
<li><strong>Extensive analysis</strong>：正确率比较高（误判几乎为0，只有0.2%的文件损失）、健壮性好<br>大大减少了文件损失和攻击者的利润。</li>
</ul>
<h2 id="4、相关工作（RELATE-WORK）"><a href="#4、相关工作（RELATE-WORK）" class="headerlink" title="4、相关工作（RELATE WORK）"></a>4、相关工作（RELATE WORK）</h2><h4 id="现存的技术区分程序是否为恶意软件，主要依靠两个特性：-异常检测的IDE系统使用的就是不同的机器学习和数据分析技术来甄别"><a href="#现存的技术区分程序是否为恶意软件，主要依靠两个特性：-异常检测的IDE系统使用的就是不同的机器学习和数据分析技术来甄别" class="headerlink" title="现存的技术区分程序是否为恶意软件，主要依靠两个特性：(异常检测的IDE系统使用的就是不同的机器学习和数据分析技术来甄别)"></a>现存的技术区分程序是否为恶意软件，主要依靠两个特性：(异常检测的IDE系统使用的就是不同的机器学习和数据分析技术来甄别)</h4><h4 id="ensp-ensp-1-什么是恶意软件-ensp-ensp-2-恶意软件做什么"><a href="#ensp-ensp-1-什么是恶意软件-ensp-ensp-2-恶意软件做什么" class="headerlink" title="&ensp; &ensp;1.什么是恶意软件 &ensp; &ensp;   2.恶意软件做什么"></a>&ensp; &ensp;1.什么是恶意软件 &ensp; &ensp;   2.恶意软件做什么</h4><ul>
<li>特征匹配（signature matching）没出现过的恶意软件就很难检测。逃避特征、自动打包技术</li>
<li>文件的完整性检测：（基于简单的hash值比较）文件出现变动就回提醒，无法区分合法or恶意，难用！</li>
<li>Andronio等人开发了一个Android平台上的检测工具（结合了动态和静态分析技术，如检测加密函数的调用和线程信息），桌面平台不好用。</li>
<li>本文的系统检测用户数据的变化，检测用户数据如何变化，注重于补救。</li>
</ul>
<h1 id="二、RANSOMWARE-INDICATORS"><a href="#二、RANSOMWARE-INDICATORS" class="headerlink" title="二、RANSOMWARE INDICATORS"></a>二、RANSOMWARE INDICATORS</h1><h2 id="1、三类Ransomware"><a href="#1、三类Ransomware" class="headerlink" title="1、三类Ransomware"></a>1、三类Ransomware</h2><ul>
<li><strong>A类</strong>：重写文件内容，打开文件、读内容、加密、替换信息、关闭文件。</li>
<li><strong>B类</strong>：继承A，把文件移出，干完活再移进来</li>
<li><strong>C类</strong>：打开文件，读文件，加密成一个新的文件，删除原来的文件。（独立的读写流）</li>
</ul>
<h5 id="ensp-ensp-ensp-ensp-ensp-ensp-ensp-ensp-忽略不直接修改文件的操作，如写随机数（防止数据恢复）等"><a href="#ensp-ensp-ensp-ensp-ensp-ensp-ensp-ensp-忽略不直接修改文件的操作，如写随机数（防止数据恢复）等" class="headerlink" title="&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;忽略不直接修改文件的操作，如写随机数（防止数据恢复）等"></a>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;忽略不直接修改文件的操作，如写随机数（防止数据恢复）等</h5><h2 id="2、File-Type-Changes"><a href="#2、File-Type-Changes" class="headerlink" title="2、File Type Changes"></a>2、File Type Changes</h2><p>&ensp;&ensp;这些签名描述了文件类型唯一的特定字节值的顺序和位置，而不仅仅是文件头部信息。由于文件通常在其存在过程中保持其文件类型和格式，所以对这些数据进行批量修改的行为是值得怀疑的行为。</p>
<p>&ensp;&ensp;利用 <strong>The file utility</strong> 检测文件类型的改变，但是并不是所有的类型改变都是恶意的，有可能是程序更新。比如doc→docx</p>
<h2 id="3、Similarity-Measurement-27-40"><a href="#3、Similarity-Measurement-27-40" class="headerlink" title="3、Similarity Measurement[27]][40]"></a>3、Similarity Measurement[27]][40]</h2><ul>
<li>强加密算法的输出文件不会提供有关明文的任何信息。所以说加密后的文件跟明文会完全不一样。</li>
<li>可以使用相似性保留Hash函数（similarity-preserving hash functions）来捕捉这种变化。使用sdhash来给相似性打分，0-100分，0表示一点都不一样，100表示完全一样。</li>
<li>给定最初版本的一个文件相似度散列，与该文件的加密版本应该不会匹配，因为密文不能与随机数据区分开来。因此，我们应该在比较时获得接近零的分数在比较的时候。</li>
</ul>
<h2 id="4、Shannon-Entropy"><a href="#4、Shannon-Entropy" class="headerlink" title="4、Shannon Entropy"></a>4、Shannon Entropy</h2><p>香农（熵）平均信息量，加密或压缩后的文件熵值很高，通过下面的公式计算熵值，e产生从0到8的值，其中8表示字节值的完美均匀分布阵列。加密文件将趋于接近8，以前也有人提出过，但不是专注于信息改变，而是为了区分勒索软件。<br>公式：（见论文）</p>
<h2 id="5、Secondary-Indicators-Union-Indication"><a href="#5、Secondary-Indicators-Union-Indication" class="headerlink" title="5、Secondary Indicators Union Indication"></a>5、Secondary Indicators Union Indication</h2><ul>
<li><p><strong>Deletion</strong>：程序经常会删除创建文件，这并不是一个可疑操作，但是删除大量的文件可能就是恶意操作了，如C类勒索软件</p>
</li>
<li><p><strong>File type funneling</strong>：用它读取多个文件类型，但只写一个类型在执行期间并不罕见， Ransomware利用这种情况的极端。当ransomware加密和写入数据时，我们会看到更少的输出文件类型，通过跟踪进程读取的文件类型的数量，设置阈值，超过阈值就是可疑的。(eg:Word)</p>
</li>
</ul>
<h2 id="6、Union-Indication"><a href="#6、Union-Indication" class="headerlink" title="6、Union Indication"></a>6、Union Indication</h2><p>While exploring the behavior of ransomware, we observed that none of the benign programs we tested triggered all three of our primary ransomware indicators, while the vast majority of ransomware samples did. We demonstrate in Section V that this union of primary indicators is crucial for early detection. Although each indicator provides value in isolation, we use union indication to take action faster.（总结：又好又快，联合指标检测打头阵）</p>
<h2 id="7、Indicator-Evasion"><a href="#7、Indicator-Evasion" class="headerlink" title="7、Indicator Evasion"></a>7、Indicator Evasion</h2><p>However, evading the union of our three primary indicators will require significant effort on the part of an adversary. For instance, while padding a file with low entropy bits may cause our detector to miss it, such behavior will also concurrently skew similarity hashes. Attempts to make output files appear to maintain their original format may also be possible, but not without dramatically skewing the remaining two indicators.（绕过一个绕不过俩），总之就是很难绕过这些特征标识。</p>
<h1 id="三、实现"><a href="#三、实现" class="headerlink" title="三、实现"></a>三、实现</h1><ul>
<li>CryptoDrop focuses on detecting ransomware through monitoring the real-time change of user data. </li>
<li>The union of these individual indicators provides a strong measure of suspiciousness of a process. </li>
<li>By tracking these indicators and monitoring for this condition in a single running process over time, we can develop a reputation score that indicates whether or not the program is likely behaving maliciously.</li>
<li>Once a threshold score is reached, CryptoDrop alerts the user and suspends the suspicious process (or family of processes).</li>
<li>In this way, we can prevent ransomware from completely encrypting a victim’s files, and contain the amount of damage in the event of infection. The primary challenge in constructing this system is detecting ransomware early while limiting false positives that could make the system impractical to use.</li>
</ul>
<h2 id="A-Reputation-Scoreboard"><a href="#A-Reputation-Scoreboard" class="headerlink" title="A. Reputation Scoreboard"></a>A. Reputation Scoreboard</h2><p>顾名思义，需要维护一个进程的“信誉”分数板，当一个进程触发某个标识符的时候就给它加分，一旦达到某个可疑的阈值，挂起进程，请求用户的权限。</p>
<h2 id="B-Union-Indication-Scoring"><a href="#B-Union-Indication-Scoring" class="headerlink" title="B. Union Indication Scoring"></a>B. Union Indication Scoring</h2><ul>
<li>没有合法进程会触发三个指标，打分机制使我们能够保持我们的得分阈值低的情况下不会引起显着的误报，研究表明单一指标检测机制的情况下有很高的几率会产生误报，三个指标的情况下就低得多。</li>
<li>CryptoDrop的可靠性由ransomware的典型行为加强，这种行为经常触发所有三个主要指标</li>
</ul>
<h2 id="C-State-Tracking-and-Score-Assessment"><a href="#C-State-Tracking-and-Score-Assessment" class="headerlink" title="C. State Tracking and Score Assessment"></a>C. State Tracking and Score Assessment</h2><ul>
<li>我们利用了一个使用用允许我们介入进程和文件系统之间的调用的驱动程序的Windows内核。这样的方法使我们不仅可以检测何时文件被更改，也是为了防止我们的机制被恶意软件修改。 这种方法也防止了干扰磁盘加密系统（例如BitLocker），它们在文件系统和磁盘之间进行操作。</li>
<li>熵测量：Ransomware经常写付款指示。这些小的低熵写入过度影响熵的平均值。这个权重确保了低熵和小的读/写操作不会过度的影响平均值。</li>
<li><p>当受保护的文件被读取或写入时，我们计算出执行操作过程中该操作涉及的字节的熵更新读写操作的加权平均数。然后计算读写差值，差值超过0.1，说明行为可疑。</p>
</li>
<li><p>这种测量是无状态的，每次超过阈值的读写原子操作都会发生。尽管阈值相比熵值很小，但是它提供了一种检测小的熵值增加的压缩文件操作的解决方法。</p>
</li>
</ul>
<h1 id="四、实验评估"><a href="#四、实验评估" class="headerlink" title="四、实验评估"></a>四、实验评估</h1><h2 id="A-实验准备"><a href="#A-实验准备" class="headerlink" title="A.实验准备"></a>A.实验准备</h2><ul>
<li>构造了5099个文件，放在了有511条目录的路径树当中</li>
<li>Windows7 SPI（64bit）2GB内存，关闭防火墙和反病毒软件等</li>
<li>以管理员身份运行</li>
<li>网络访问限制在主机的网络栈中</li>
<li>每次实验虚拟机都要回退到上个快照状态</li>
<li>安装CryptoDrop并且设置非联合检测的阈值为200</li>
<li>拿到了2663个恶意软件的样本，剔除了2171个（不能用的），剩下492（都修改用户数据）个，分属于14个家族。</li>
</ul>
<h2 id="B-恶意软件检测"><a href="#B-恶意软件检测" class="headerlink" title="B.恶意软件检测"></a>B.恶意软件检测</h2><h3 id="1-保护数据的能力-Data-Loss"><a href="#1-保护数据的能力-Data-Loss" class="headerlink" title="1.保护数据的能力-Data Loss"></a>1.保护数据的能力-Data Loss</h3><ul>
<li>在检测到之前丢失数据的量是最有价值的度量，CryptoDrop检测越快，丢失的文件就越少，因此就能保护更多的文件。</li>
<li>有些软件会对不同类型文件有不同的优先级，但是这并不会影响CryptoDrop的检测能力，通过主要指标就可以很快发现恶意软件。</li>
<li>5099文件中大约10个文件会丢失（0.2%）</li>
<li>B类恶意软件会有较高的丢失率（优先攻击小文件）</li>
<li>性能强于普通的</li>
</ul>
<h3 id="2-联合指标的有效性"><a href="#2-联合指标的有效性" class="headerlink" title="2.联合指标的有效性"></a>2.联合指标的有效性</h3><ul>
<li>试验中，三个主要指标是被证明在大部分样本中很有价值的。93%的样本都触发了联合指标检测，可以通过加快分数的增加和降低阈值来减少文件损失。</li>
<li>C类恶意软件可以逃脱联合指标检测，因为它将数据写入不同的文件。因为写操作熵值大，需要删除大量文件还是会被检测出来。</li>
<li>CryptoDrop的低非联合阈值机制允许检测到前丢失中位数为6个的文件数量。</li>
<li>关键的是加快了检测速度，把文件损失减少为一个。</li>
</ul>
<h2 id="C-以数据为中心的勒索软件行为"><a href="#C-以数据为中心的勒索软件行为" class="headerlink" title="C.以数据为中心的勒索软件行为"></a>C.以数据为中心的勒索软件行为</h2><ul>
<li>我们最初预计会发现大多数ransomware样品使用目录的有序列表执行深度优先搜索并在达到最深的文件后，依次加密它们。实验发现，并不是这样，如图4所示。</li>
<li>TeslaCrypt使用深度优先搜索，到达最深文件后开始访问文件，并不在第一个目录中加密文件，而是写解密指令或赎金要求，从第二个目录的PDF开始加密。</li>
<li>CTB-Locker只攻击特定的扩展名（.txt.md）,根据文件大小升序排列。按照顺序加密，无论是否在一个目录里, sdhash无法生成小文件的相似度分数，导致联合检测是不可能的。以后版本的CryptoDrop可以通过自动识别这种不利情况解决这个问题。一旦确定，CryptoDrop可以调整个别指标评估信誉分数。</li>
<li>GPcode从根部开始访问文件，不删除文件，删除文件内容，但是有些文件只读权限，所以可能什么都做不了。通过写的熵值还是可以检测到。</li>
<li>恶意软件攻击的文件的排序影响CryptoDrop检测和停止ransomware的速度。未来还需要做一些优化工作，动态评分工作，但是可能会对误报产生不利影响</li>
</ul>
<h2 id="D-文件格式攻击频率"><a href="#D-文件格式攻击频率" class="headerlink" title="D.文件格式攻击频率"></a>D.文件格式攻击频率</h2><p>见图</p>
<h2 id="E-Ransomware-Script"><a href="#E-Ransomware-Script" class="headerlink" title="E.Ransomware Script"></a>E.Ransomware Script</h2><ul>
<li>PoshCoder，不需要编译成二进制，容易变异，基于特征识别的反病毒软件检测率大大降低，CryptoDrop检测只有11个文件损失。</li>
<li>由于CryptoDrop专注于更改对用户数据而不是恶意软件的内容或其执行，我们的系统很好地停止了ransomware使用高级API操纵文件系统。</li>
</ul>
<h2 id="F-False-Positive"><a href="#F-False-Positive" class="headerlink" title="F.False Positive"></a>F.False Positive</h2><ul>
<li>对于CryptoDrop来说，误报分析很很困难的。</li>
<li>静态分析不行，因为CryptoDrop不分析软件的二进制特征</li>
<li>动态分析不行，因为CryptoDrop需要在每次更改之前和之后测量用户的文档</li>
<li>所以试验中论文加入良性软件来证明系统的健壮性</li>
<li>测试了30个Windows程序，只有一个误报（7.zip），而且没有英语触发三个指标。</li>
<li>分析五个重要的应用Adobe Lightroom (107)、ImageMagick (0)、iTunes (16)、Microsoft Word (0)、Microsoft Excel (150)</li>
<li>在我们的分析中，我们展示了我们的阈值选择可以最大限度地减少误报，同时保持快速检测勒索。</li>
<li>研究时间窗口参数化可能导致另一个主要指示器在未来版本的CryptoDrop。</li>
</ul>
<h2 id="G-限制"><a href="#G-限制" class="headerlink" title="G.限制"></a>G.限制</h2><p>CryptDrop无法知道文件发生改变的目的，无法区分是用户还是恶意软件（加密软件PGP、GPG、一些压缩软件，未来恶意软件也可能利用这些软件），但是CryptoDrop主要针对大宗的信息转换。不怕一万就怕万一！</p>
<h2 id="H-性能"><a href="#H-性能" class="headerlink" title="H.性能"></a>H.性能</h2><p>最初设计没有考虑优化，有很延迟操作，如写和重命名，CryptoDrop不检查用户文档以外的文件目录，所以操作系统和程序访问其他文件（包括自己的）不受影响。写入和重命名的高延迟操作经常在测量过程中出现，所以一个主要的优化是执行这些测量的时候不需要额外的磁盘访问，这样会大大减少了这些延迟。CryptoDrop可以在具有较小开销的实时系统上运行</p>
<h1 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h1><p>&ensp;&ensp;&ensp;&ensp;限制攻击者，减少对受害者损失，这是一种用于勒索软件攻击预警的系统。我们的解决方案是通过监控受害者的数据和ransomware必须的行为来实现的。首先确定这些所需的操作，进行分类ransomware分为三大类，并发现Ransomware的三个主要行为指标，找到一种低文件丢失率检测的快捷方式，针对ransomware规模最大的研究</p>
<h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><ul>
<li>[1]OPF format corpus. <a href="http://openpreservation.org/technology/corpora/opf-format-corpus/" target="_blank" rel="external">http://openpreservation.org/technology/corpora/opf-format-corpus/</a>.</li>
<li>[2] N. Agrawal, W. J. Bolosky, J. R. Douceur, and J. R. Lorch. A five-year study offile-system metadata. ACM Transactions on Storage (TOS), 2007.</li>
<li>[3] N. Andronio, S. Zanero, and F. Maggi. HelDroid: Dissecting and detecting mobile ransomware. In Proceedings of the International Symposium on Research inAttacks, Intrusion and Detection (RAID), 2015.</li>
<li>[4] E. Arnold. Tennessee sheriff pays ransom to cybercriminals,<br>in bitcoin. <a href="http://www.bizjournals.com/memphis/blog/2014/11/" target="_blank" rel="external">http://www.bizjournals.com/memphis/blog/2014/11/</a><br>tennessee-sheriff-pays-ransom-to-cybercriminals-in.html, 2014.</li>
<li>[5] S. Axelsson. The base-rate fallacy and its implications for the difficulty of<br>intrusion detection. In Proceedings of the ACM Conference on Computer and<br>Communications Security (CCS), 1999.</li>
<li>[6] D. Carrigan. Police departments hit by ransomware virus. <a href="http://www.wcsh6" target="_blank" rel="external">http://www.wcsh6</a>.<br>com/story/news/local/2015/04/10/police-departments-hit-by-ransomware-virus/<br>25593777/, 2015.</li>
<li>[7] S. Chakradeo, B. Reaves, P. Traynor, and W. Enck. MAST: Triage for marketscale<br>mobile malware analysis. In Proceedings of ACM Conference on Security<br>and Privacy in Wireless and Mobile Networks (WiSec). ACM, 2013.</li>
<li>[8] V. Chandola, A. Banerjee, and V. Kumar. Anomaly detection: A survey. ACM<br>Comput. Surv., 41(3), 2009.</li>
<li>[9] X. Chen, J. Andersen, Z. M. Mao, M. Bailey, and J. Nazario. Towards an understanding<br>of anti-virtualization and anti-debugging behavior in modern malware.<br>In IEEE International Conference on Dependable Systems and Networks, 2008.</li>
<li>[10] N. Coldwell. Comparison of audio compression. <a href="http://nigelcoldwell.co.uk/audio/" target="_blank" rel="external">http://nigelcoldwell.co.uk/audio/</a>.</li>
<li>[11] D. Common. Ransomware victims pay cybercriminals<br>to save family photos. <a href="http://www.cbc.ca/news/technology/" target="_blank" rel="external">http://www.cbc.ca/news/technology/</a><br>ransomware-victims-pay-cybercriminals-to-save-family-photos-1.2962106,<br>2015.</li>
<li>[12] Cuckoo Foundation. Automated malware analysis - cuckoo sandbox. <a href="http://www" target="_blank" rel="external">http://www</a>.<br>cuckoosandbox.org/.</li>
<li>[13] C. Cuevas and C. Shaffer. Raising the white flag. <a href="http://www.shmoocon.org/2012/" target="_blank" rel="external">http://www.shmoocon.org/2012/</a><br>videos/ShafferCuevas-RaisingTheWhiteFlag.m4v, 2012. Presented at ShmooCon.</li>
<li>[14] T. Dewan. Teslacrypt joins ransomware field. <a href="https://blogs.mcafee.com/" target="_blank" rel="external">https://blogs.mcafee.com/</a><br>mcafee-labs/teslacrypt-joins-ransomware-field, 2015.</li>
<li>[15] C. J. Dietrich, C. Rossow, and N. Pohlmann. Exploiting visual appearance to<br>cluster and detect rogue software. In Proceedings of the ACM Symposium on<br>Applied Computing. ACM, 2013.</li>
<li>[16] J. R. Douceur and W. J. Bolosky. A large-scale study of file-system contents. In<br>Proceedings of the ACM SIGMETRICS International Conference on Measurement<br>and Modeling of Computer Systems, 1999.</li>
<li>[17] S. Forrest, S. A. Hofmeyr, A. Somayaji, and T. A. Longstaff. A sense of self for<br>unix processes. In Proceedings of the IEEE Symposium on Security and Privacy<br>(S&amp;P), 1996.</li>
<li>[18] B. Fraga. Swansea police pay $750 “ransom” after computer virus strikes. The<br>Herald News, 2013.</li>
<li>[19] S. Garfinkel, P. Farrell, V. Roussev, and G. Dinolt. Bringing science to digital<br>forensics with standardized forensic corpora. Digital Investigation, 6, Supplement(<br>0), 2009.</li>
<li>[20] G. Gu, P. Porras, V. Yegneswaran, M. Fong, and W. Lee. BotHunter: detecting<br>malware infection through IDS-driven dialog correlation. In Proceedings of the<br>USENIX Security Symposium, 2007.</li>
<li>[21] D. Hadˇziosmanovi′c, L. Simionato, D. Bolzoni, E. Zambon, and S. Etalle. N-gram<br>against the machine: On the feasibility of the N-gram network analysis for binary<br>protocols. In Proceedings of the International Symposium on Research in Attacks,<br>Intrusion and Detection (RAID), 2012.</li>
<li>[22] B. J. Hicks, A. Dong, R. Palmer, and H. C. Mcalpine. Organizing and managing<br>personal electronic files: A mechanical engineer’s perspective. ACM Transactions<br>on Information Systems (TOIS), 26(4), 2008.</li>
<li>[23] S. A. Hofmeyr, S. Forrest, and A. Somayaji. Intrusion detection using sequences<br>of system calls. International Journal of Information and Computer Security,<br>6(3), 1998.</li>
<li>[24] S. Jana and V. Shmatikov. Abusing file processing in malware detectors for fun<br>and profit. In IEEE Symposium on Security and Privacy (S&amp;P), 2012.</li>
<li>[25] A. Kharraz, W. Robertson, D. Balzarotti, L. Bilge, and E. Kirda. Cutting the<br>gordian knot: A look under the hood of ransomware attacks. DIMVA, 2015.</li>
<li>[26] G. H. Kim and E. H. Spafford. The design and implementation of tripwire: A file<br>system integrity checker. In Proceedings of the ACM Conference on Computer<br>and Communications Security, 1994.</li>
<li>[27] J. Kornblum. Identifying almost identical files using context triggered piecewise<br>hashing. Digital Investigation, 3, Supplement(0), 2006.</li>
<li>[28] S. Kumar and E. H. Spafford. A generic virus scanner for c++. In Proceedings<br>of the Computer Security Applications Conference, 1992.</li>
<li>[29] A. Lanzi, D. Balzarotti, C. Kruegel, M. Christodorescu, and E. Kirda. Access-<br>Miner: Using system-centric models for malware protection. In Proceedings of<br>the ACM Conference on Computer and Communications Security (CCS), 2010.</li>
<li>[30] C. Lever, M. Antonakakis, B. Reaves, P. Traynor, and W. Lee. The core of the<br>matter: Analyzing malicious traffic in cellular carriers. In Proceedings of the<br>Network and Distributed System Security Symposium (NDSS), 2013.</li>
<li>[31] R. Lyda and J. Hamrock. Using entropy analysis to find encrypted and packed<br>malware. IEEE Security and Privacy, 5(2), 2007.</li>
<li>[32] D. Maiorca, I. Corona, and G. Giacinto. Looking at the bag is not enough<br>to find the bomb: An evasion of structural methods for malicious PDF files<br>detection. In Proceedings of the ACM Symposium on Information, Computer<br>and Communications Security, 2013.</li>
<li>[33] J. A. P. Marpaung, M. Sain, and H.-J. Lee. Survey on malware evasion techniques:<br>State of the art and challenges. In International Conference on Advanced<br>Communication Technology (ICACT), 2012.</li>
<li>[34] Y. Nadji, J. Giffin, and P. Traynor. Automated remote repair for mobile malware.<br>In Proceedings of the Annual Computer Security Applications Conference<br>(ACSAC). ACM, 2011.</li>
<li>[35] J. Oberheide, M. Bailey, and F. Jahanian. PolyPack: An automated online packing<br>service for optimal antivirus evasion. In Proceedings of the USENIX Conference<br>on Offensive Technologies, 2009.</li>
<li>[36] J. Oberheide, E. Cooke, and F. Jahanian. CloudAV: N-Version antivirus in the<br>network cloud. In USENIX Security Symposium, 2008.</li>
<li>[37] G. O’Gorman and G. McDonald. Ransomware: A growing menace. Technical<br>report, Symantec Corporation, 2012.</li>
<li>[38] A. Patcha and J.-M. Park. An overview of anomaly detection techniques: Existing<br>solutions and latest technological trends. Computer Networks, 51(12), 2007.</li>
<li>[39] R. Perdisci, A. Lanzi, and W. Lee. Classification of packed executables for<br>accurate computer virus detection. Pattern recognition letters, 29(14), 2008.</li>
<li>[40] V. Roussev. Data fingerprinting with similarity digests. In Advances in Digital<br>Forensics VI, IFIP Advances in Information and Communication Technology.<br>Springer Berlin Heidelberg, 2010.</li>
<li>[41] N. Scaife, H. Carter, and P. Traynor. OnionDNS: A seizure-resistant top-level<br>domain. In In IEEE Conference on Communications and Network Security (CNS),<br>2015.</li>
<li>[42] I. Sorokin. Comparing files using structural entropy. Journal in Computer<br>Virology, 7(4), 2011.</li>
<li>[43] A. Tang, S. Sethumadhavan, and S. Stolfo. Unsupervised Anomaly-based<br>Malware Detection using Hardware Features. In Proceedings of the International<br>Symposium on Research in Attacks, Intrusion and Detection (RAID), 2014.</li>
<li>[44] D. J. Tian, A. Bates, and K. Butler. Defending against malicious USB firmware<br>with GoodUSB. In Proceedings of the Annual Computer Security Applications<br>Conference (ACSAC). ACM, 2015.</li>
<li>[45] P. Traynor, M. Chien, S. Weaver, B. Hicks, and P. McDaniel. Noninvasive methods<br>for host certification. ACM Transactions on Information and System Security,<br>11(3), 2008.</li>
<li>[46] X. Ugarte-Pedrero, D. Balzarotti, I. Santos, P. G. Bringas, and S. Antipolis. SoK<br>: Deep Packer Inspection : A Longitudinal Study of the Complexity of Run-Time<br>Packers. In IEEE Symposium on Security and Privacy (S&amp;P), 2015.</li>
<li>[47] A. Viswanathan, K. Tan, and C. Neuman. Deconstructing the assessment of<br>anomaly-based intrusion detectors. In Proceedings of the International Symposium<br>on Research in Attacks, Intrusion and Detection (RAID), 2013.</li>
<li>[48] J. Walter. Meet tox: Ransomware for the rest of us. <a href="https://blogs.mcafee.com/" target="_blank" rel="external">https://blogs.mcafee.com/</a><br>mcafee-labs/meet-tox-ransomware-for-the-rest-of-us/, 2015.</li>
<li>[49] C. Warrender, S. Forrest, and B. Pearlmutter. Detecting intrusions using system<br>calls: alternative data models. In Proceedings of the IEEE Symposium on Security<br>and Privacy (S&amp;P), 1999.</li>
<li>[50] H. Weisbaum. CryptoLocker crooks launch ‘customer service’ site. <a href="http://www" target="_blank" rel="external">http://www</a>.<br>cnbc.com/id/101195861, 2013.</li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/05/14/SMS-短信加密程序/" rel="next" title="SMS-短信加密程序">
                <i class="fa fa-chevron-left"></i> SMS-短信加密程序
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/05/20/活法/" rel="prev" title="活法">
                活法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        
<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="Mr.Chen" />
          <p class="site-author-name" itemprop="name">Mr.Chen</p>
           
              <p class="site-description motion-element" itemprop="description">Write everyday</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/tags/index.html">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/MrChenA" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/chen-yan-hui-5-88" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/3196979860" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#目录"><span class="nav-number">1.</span> <span class="nav-text">目录</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PS：平时多备份，灾时少流泪！"><span class="nav-number"></span> <span class="nav-text">PS：平时多备份，灾时少流泪！</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#一、介绍和相关工作"><span class="nav-number"></span> <span class="nav-text">一、介绍和相关工作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、现状"><span class="nav-number">1.</span> <span class="nav-text">1、现状</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、难点"><span class="nav-number">2.</span> <span class="nav-text">2、难点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、论文所做工作"><span class="nav-number">3.</span> <span class="nav-text">3、论文所做工作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、相关工作（RELATE-WORK）"><span class="nav-number">4.</span> <span class="nav-text">4、相关工作（RELATE WORK）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#现存的技术区分程序是否为恶意软件，主要依靠两个特性：-异常检测的IDE系统使用的就是不同的机器学习和数据分析技术来甄别"><span class="nav-number">4.0.1.</span> <span class="nav-text">现存的技术区分程序是否为恶意软件，主要依靠两个特性：(异常检测的IDE系统使用的就是不同的机器学习和数据分析技术来甄别)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ensp-ensp-1-什么是恶意软件-ensp-ensp-2-恶意软件做什么"><span class="nav-number">4.0.2.</span> <span class="nav-text">   1.什么是恶意软件       2.恶意软件做什么</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、RANSOMWARE-INDICATORS"><span class="nav-number"></span> <span class="nav-text">二、RANSOMWARE INDICATORS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、三类Ransomware"><span class="nav-number">1.</span> <span class="nav-text">1、三类Ransomware</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ensp-ensp-ensp-ensp-ensp-ensp-ensp-ensp-忽略不直接修改文件的操作，如写随机数（防止数据恢复）等"><span class="nav-number">1.0.0.1.</span> <span class="nav-text">        忽略不直接修改文件的操作，如写随机数（防止数据恢复）等</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、File-Type-Changes"><span class="nav-number">2.</span> <span class="nav-text">2、File Type Changes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、Similarity-Measurement-27-40"><span class="nav-number">3.</span> <span class="nav-text">3、Similarity Measurement[27]][40]</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、Shannon-Entropy"><span class="nav-number">4.</span> <span class="nav-text">4、Shannon Entropy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、Secondary-Indicators-Union-Indication"><span class="nav-number">5.</span> <span class="nav-text">5、Secondary Indicators Union Indication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、Union-Indication"><span class="nav-number">6.</span> <span class="nav-text">6、Union Indication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7、Indicator-Evasion"><span class="nav-number">7.</span> <span class="nav-text">7、Indicator Evasion</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、实现"><span class="nav-number"></span> <span class="nav-text">三、实现</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-Reputation-Scoreboard"><span class="nav-number">1.</span> <span class="nav-text">A. Reputation Scoreboard</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-Union-Indication-Scoring"><span class="nav-number">2.</span> <span class="nav-text">B. Union Indication Scoring</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#C-State-Tracking-and-Score-Assessment"><span class="nav-number">3.</span> <span class="nav-text">C. State Tracking and Score Assessment</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四、实验评估"><span class="nav-number"></span> <span class="nav-text">四、实验评估</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-实验准备"><span class="nav-number">1.</span> <span class="nav-text">A.实验准备</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-恶意软件检测"><span class="nav-number">2.</span> <span class="nav-text">B.恶意软件检测</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-保护数据的能力-Data-Loss"><span class="nav-number">2.1.</span> <span class="nav-text">1.保护数据的能力-Data Loss</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-联合指标的有效性"><span class="nav-number">2.2.</span> <span class="nav-text">2.联合指标的有效性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#C-以数据为中心的勒索软件行为"><span class="nav-number">3.</span> <span class="nav-text">C.以数据为中心的勒索软件行为</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#D-文件格式攻击频率"><span class="nav-number">4.</span> <span class="nav-text">D.文件格式攻击频率</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#E-Ransomware-Script"><span class="nav-number">5.</span> <span class="nav-text">E.Ransomware Script</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#F-False-Positive"><span class="nav-number">6.</span> <span class="nav-text">F.False Positive</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#G-限制"><span class="nav-number">7.</span> <span class="nav-text">G.限制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#H-性能"><span class="nav-number">8.</span> <span class="nav-text">H.性能</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五、总结"><span class="nav-number"></span> <span class="nav-text">五、总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#参考文献"><span class="nav-number">0.1.</span> <span class="nav-text">参考文献</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mr.Chen</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://yoursite.com/2017/05/15/CryptoLock-Stopping-Ransomware-Attacks-on-User-Data/';
          this.page.identifier = '2017/05/15/CryptoLock-Stopping-Ransomware-Attacks-on-User-Data/';
          this.page.title = 'CryptoLock Stopping Ransomware Attacks on User Data';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (search_path.endsWith("json")) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("MJnlsvNexA0FYtyNkI8cgo9y-gzGzoHsz", "xxpud92U58R0TiwQEXWrCCcK");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

</body>
</html>
